<%- include('./partials/header') %>

<div class="w-full min-h-screen flex justify-center items-start py-16 bg-gray-100">
  <div class="bg-white rounded-xl shadow-md p-8 w-2/5">
    <h2 class="text-2xl font-semibold mb-6 text-center">Edit Profile</h2>

    <form action="/users/profile/edit" method="POST" enctype="multipart/form-data" class="space-y-4">
      <div class="flex flex-col items-center">
        <% if (user.profileImage) { %>
          <img id="preview" class="w-28 h-28 rounded-full object-cover border-2 border-gray-300 mb-4" src="data:image/jpeg;base64,<%= user.profileImage.toString('base64') %>" alt="Profile Image">
        <% } else { %>
          <img id="preview" class="w-28 h-28 rounded-full object-cover border-2 border-gray-300 mb-4" src="/images/placeholder.png" alt="Profile Image">
        <% } %>
        <input type="file" name="profileImage" accept="image/*" onchange="previewImage(event)" class="text-sm text-gray-500">
      </div>

      <div>
        <label class="font-medium">Name</label>
        <input type="text" name="name" value="<%= user.name %>" class="w-full border rounded px-3 py-2 mt-1" required>
      </div>

      <div>
        <label class="font-medium">Phone</label>
        <input type="text" name="phone" value="<%= user.phone %>" class="w-full border rounded px-3 py-2 mt-1">
      </div>

      <div>
        <label class="font-medium">Address</label>
        <textarea name="address" class="w-full border rounded px-3 py-2 mt-1"><%= user.address %></textarea>
      </div>

      <div class="text-center mt-4">
        <button type="submit" class="px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition">Update Profile</button>
      </div>
    </form>
  </div>
</div>

<script>
  function previewImage(event) {
    const reader = new FileReader();
    reader.onload = function() {
      const output = document.getElementById('preview');
      output.src = reader.result;
    }
    reader.readAsDataURL(event.target.files[0]);
  }
</script>

<%- include('./partials/footer') %>
